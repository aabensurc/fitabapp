<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#007bff">
  <meta name="description" content="Mi PWA con Bootstrap y JSON">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.10.0/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="manifest" href="manifest.json">
  <title>FITABAPP</title>

  <!-- Incluir el archivo auth.js -->
  <script src="js/auth.js"></script>
  <script>
    // Llamar a la función para verificar si el usuario está logueado
    window.addEventListener('load', checkLogin);
  </script>
</head>
<body>
  <!-- App Bar -->
  <div class="app-bar">
    <h1>Dieta del día</h1> <!-- Título dinámico -->
    <div class="nav-icons"></div>
  </div>

  <div class="container-fluid" id="container-nutricion">
    <h1>Dieta del Día</h1>
    <div id="dieta"></div>
</div>

<script>
    // Función para obtener el día de la semana
    function obtenerDiaDeLaSemana() {
        const dias = ["domingo", "lunes", "martes", "miércoles", "jueves", "viernes", "sábado"];
        const hoy = new Date();
        return dias[hoy.getDay()]; // Devuelve el nombre del día actual
    }

    // Cargar dietas y mostrar la dieta del día
    async function cargarDieta() {
        const usuario = localStorage.getItem('username'); // Obtener nombre de usuario
        const diaActual = obtenerDiaDeLaSemana(); // Obtener el día actual
        
        try {
            const response = await fetch('json/dietas.json'); // Cargar el archivo JSON
            const dietas = await response.json(); // Convertir a objeto JSON

            // Buscar la dieta del usuario
            const dietaUsuario = dietas.find(dieta => dieta.usuario === usuario);

            if (dietaUsuario) {
                const comidasDelDia = dietaUsuario[diaActual]; // Obtener las comidas del día
                let contenido = `<h2>Dieta para ${diaActual.charAt(0).toUpperCase() + diaActual.slice(1)}:</h2>`;
                
                for (const [comida, alimentos] of Object.entries(comidasDelDia)) {
                    contenido += `
                    <div class="card mb-3">
                        <div class="card-header bg-primary text-white" id="heading-${comida}">
                            <h5 class="mb-0">
                                <button class="btn btn-link text-white" type="button" data-bs-toggle="collapse" data-bs-target="#collapse-${comida}" aria-expanded="true" aria-controls="collapse-${comida}">
                                    ${comida.charAt(0).toUpperCase() + comida.slice(1)}
                                </button>
                            </h5>
                        </div>
                        <div id="collapse-${comida}" class="collapse show" aria-labelledby="heading-${comida}" data-bs-parent="#dieta">
                            <div class="card-body">
                                <ul>`;
                    alimentos.forEach(alimento => {
                        contenido += `<li>${alimento.cantidad} ${alimento.unidad} de ${alimento.alimento}</li>`;
                    });
                    contenido += `</ul>
                            </div>
                        </div>
                    </div>`;
                }

                document.getElementById('dieta').innerHTML = contenido; // Mostrar en el contenedor
            } else {
                document.getElementById('dieta').innerHTML = "<p>No se encontró la dieta para el usuario.</p>";
            }
        } catch (error) {
            console.error('Error al cargar las dietas:', error);
            document.getElementById('dieta').innerHTML = "<p>Error al cargar las dietas.</p>";
        }
    }

    // Llamar a la función para cargar la dieta al cargar la página
    window.onload = cargarDieta;
</script>


  <!-- Bottom Navigation -->
  <nav class="navbar navbar-expand fixed-bottom navbar-light p-0" style="background-color: #2196F3;">
    <div class="container-fluid p-0 m-0">
      <ul class="navbar-nav w-100 d-flex justify-content-between">
        <li class="nav-item text-center">
          <a class="nav-link text-white" href="index.html">
            <i class="bi bi-house-fill" style="font-size: 24px;"></i><br>
            Inicio
          </a>
        </li>
        <li class="nav-item text-center">
          <a class="nav-link text-white" href="ejercicios.html">
            <i class="bi bi-headset-vr" style="font-size: 24px;"></i><br>
            Ejercicios
          </a>
        </li>
        <li class="nav-item text-center">
          <a class="nav-link text-white active" href="nutricion.html">
            <i class="bi bi-apple" style="font-size: 24px;"></i><br>
            Nutrición
          </a>
        </li>
        <li class="nav-item text-center">
          <a class="nav-link text-white" href="contacto.html">
            <i class="bi bi-envelope-fill" style="font-size: 24px;"></i><br>
            Contacto
          </a>
        </li>
      </ul>
    </div>
  </nav>

  <!-- Bootstrap JS and dependencies -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
